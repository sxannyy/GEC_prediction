# GEC_prediction
Этот проект предназначен для загрузки изображений солнечной активности с сервиса Helioviewer.org и построения прогноза геомагнитного индекса GEC на основе полученных данных.

## Содержимое проекта
* download_data_script.py — скрипт для автоматической загрузки изображений с Helioviewer.org на основе временных меток из файла gec.csv.
* Прогноз_GEC.ipynb — ноутбук с исследованием, обучением и визуализациями. Рекомендуется открывать в Google Colab. Обучение занимает 10-20 минут на T4.

## Загрузка изображений
Скрипт _download_data_script.py_ загружает изображения солнечной короны в разных каналах AIA (171, 193, 211, 304, 335 Å) за каждый день в 12:00 по данным из gec.csv.

### Подготовка:
Скачайте файл gec.csv с сайта https://simurg.iszf.irk.ru/gec.
Разместите файл gec.csv в одной директории со скриптом download_data_script.py.

### Запуск:
```python
python download_data_script.py
```

## Что делает скрипт:
* Читает gec.csv и отбирает записи только с временем равным полудню.
* Для каждой даты получает ближайшее изображение от Helioviewer API.
* Скачивает изображения по пяти каналам AIA.
* Сохраняет изображения в папку data/raw_images.

## Прогноз GEC
Ноутбук содержит код для:
* Загрузки и предобработки изображений.
* Объединения изображений с временными метками и значениями GEC.
* Обучения нейросети для предсказания GEC по изображениям.

### Подготовка:
Убедитесь, что папка data/raw_images содержит изображения, загруженные с помощью download_data_script.py.
Установите необходимые библиотеки:
```python
pip install pandas numpy scikit-learn matplotlib tqdm keras tensorflow
```

### Запуск:
Откройте Прогноз_GEC.ipynb в Google Colab и последовательно выполните ячейки.

## Структура данных
Файл gec.csv должен содержать колонки: Year, Month, Day, Hour, igsg.
Скачанные изображения сохраняются в формате:
```
YYYYMMDD_HHMMSS_AIA_<channel>.jpg
Пример: 20150101_120000_AIA_171.jpg
```
